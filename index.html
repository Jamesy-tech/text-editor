<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/monokai.min.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="icon.png">
  <title>Jamesy Creator Code</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: monospace;
      background-color: #1e1e2f;
      color: #ccc;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .menu-bar {
      background: #2d2d3a;
      padding: 6px 12px;
      display: flex;
      gap: 20px;
    }
    .menu-bar button {
      background: none;
      color: #ccc;
      border: none;
      font-family: verdana;
      cursor: pointer;
      font-size: 14px;
    }
    .menu-bar button:hover {
      color: white;
    }
    .editor-wrapper {
      flex: 1;
      display: flex;
    }
    .sidebar {
      width: 180px;
      background: #252537;
      padding: 10px;
      border-right: 1px solid #333;
      overflow-y: auto;
    }
    .sidebar h3 {
      color: #aaa;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .sidebar ul {
      list-style: none;
      padding-left: 0;
    }
    .sidebar li {
      padding: 6px 10px;
      color: #ddd;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      position: relative;
      text-decoration: none;
    }
    .sidebar li.active {
      background: #444;
    }
    .sidebar li:hover {
      background: #333;
    }
    .code-area {
      flex: 1;
      background: #1e1e2f;
      padding: 10px;
      overflow: auto;
      position: relative;
    }
    .editor-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    #editor {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      color:white;
      caret-color: white;
      border: none;
      font-family: monospace;
      font-size: 14px;
      outline: none;
      resize: none;
      white-space: pre;
      padding-bottom:20px;
      overflow: scroll;
      padding: 10px;
      line-height:1.2;
      z-index: 1;
      opacity: 1;
    }
    #highlight {
      position: absolute;
      top: 0;
      left: 0;
      padding-bottom:20px;
      width: 100%;
      height: 100%;
      background: transparent;
      font-family: monospace;
      font-size: 14px;
      line-height: 1.2;
      padding: 10px;
      border: none;
      white-space: pre;
      overflow: scroll;
      pointer-events: none;
      z-index: 2;
      color: transparent;
    }
    .readme-container {
      width: 100%;
      height: 100%;
      padding: 10px;
    }
    .readme-container a {
      color: #66d9ef;
      text-decoration: none;
    }
    .underline:hover {
      text-decoration: underline;
    }
    .readme-container pre {
      background: #2d2d3a;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .status-bar {
      height: 28px;
      background: #181822;
      padding: 4px 10px;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid #333;
    }
    .folder-item {
      padding-left: 20px;
      color: #888;
      display: none;
    }
    .folder-name {
      color: #66d9ef;
      position: relative;
      padding-left: 15px;
    }
    .folder-name::before {
      content: '‚ñ∂';
      position: absolute;
      left: 0;
      font-size: 10px;
    }
    .folder-name.expanded::before {
      content: '‚ñº';
    }
    .folder-name.expanded + ul .folder-item {
      display: block;
    }
    .folder-contents {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }
    .links li {
      font-size:16px;
    }
    .links {
      padding-left:10px;
    }
    .updateLog li {
      margin-left: 0px;
      line-height:25px;
      display:block;
font-size:16px;
      list-style-type: disc;
    }
  </style>
</head>
<body>
  <div class="menu-bar">
    <button onclick="newPage()">New</button>
    <button onclick="openFiles()">Open Files</button>
    <button onclick="uploadFolder()">Open Folder</button>
    <button onclick="saveFile()">Save</button>
 <button onclick="renameFile()">Rename</button>
    <button onclick="closePage()">Close File</button>
  </div>
  <div class="editor-wrapper">
    <div class="sidebar">
      <h3>Pages</h3>
      <ul id="pageList"></ul>
    </div>
    <div class="code-area" id="code-area">
      <div class="editor-container" id="code-editor">
        <pre id="highlight"></pre>
        <textarea id="editor" spellcheck="false"></textarea>
      </div>
      <div id="readme" class="readme-container" style="display:none"></div>
    </div>
  </div>
  <div class="status-bar">
    <span id="fileName">Overview</span>
    <span id="cursorPos">Ln 1, Col 1</span>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/xml.min.js"></script>
  <script>


    
    
    const editor = document.getElementById('editor');
    const highlightElement = document.getElementById('highlight');
    const readme = document.getElementById('readme');
    const cursorPos = document.getElementById('cursorPos');
    const pageList = document.getElementById('pageList');
    const fileName = document.getElementById('fileName');
    let pages = {};
    let currentPage = '';
    let folders = {};

    // Initialize Highlight.js
    hljs.configure({
      ignoreUnescapedHTML: true,
      languages: ['javascript', 'css', 'xml']
    });

    // Set up event listeners
    editor.addEventListener('input', handleEditorUpdate);
    editor.addEventListener('click', updateCursor);
    editor.addEventListener('scroll', syncScroll);
    editor.addEventListener('keydown', handleKeyDown);

    function handleEditorUpdate() {
      updateCursor();
      updateHighlighting();
      syncScroll();
    }

    function syncScroll() {
      highlightElement.scrollTop = editor.scrollTop;
      highlightElement.scrollLeft = editor.scrollLeft;
    }

    function updateHighlighting() {
    if (!currentPage || currentPage === 'Overview') return;
    
    const extension = currentPage.split('.').pop().toLowerCase();
    const code = editor.value;
    
    let language = 'plaintext';
    if (extension === 'js') {
        language = 'javascript';
        yourSuccessFunction();
    } else if (extension === 'css') {
        language = 'css';
        yourSuccessFunction(); 
    } else if (extension === 'html') {
        language = 'xml';
        yourSuccessFunction(); 
    }
    
    highlightElement.textContent = code;
    highlightElement.className = `language-${language}`;
    hljs.highlightElement(highlightElement);
}

function yourSuccessFunction() {
  const editor = document.getElementById("editor");
editor.style.backgroundColor = "transparent"; 
editor.style.caretColor = "white";  
}

    function updateCursor() {
      const pos = editor.selectionStart;
      const lines = editor.value.substr(0, pos).split("\n");
      const line = lines.length;
      const col = lines[lines.length - 1].length + 1;
      cursorPos.textContent = `Ln ${line}, Col ${col}`;
    }

    function newPage() {
      const name = prompt("Create new file", `page${Object.keys(pages).length + 1}.txt`);
      if (!name || name === 'Overview') return;
      pages[name] = "";
      addPageToList(name);
      switchPage(name);
    }

    function addPageToList(name, folderName = null) {
      if (folderName) {
        if (!folders[folderName]) {
          folders[folderName] = [];
        }
        folders[folderName].push(name);
        const folderElements = document.querySelectorAll('.folder-name');
        for (const folder of folderElements) {
          if (folder.textContent === folderName) {
            const folderContents = folder.nextElementSibling;
            const li = document.createElement('li');
            li.textContent = name;
            li.className = 'folder-item';
            li.title = name;
            li.onclick = () => switchPage(`${folderName}/${name}`);
            folderContents.appendChild(li);
            return;
          }
        }
      } else {
        const li = document.createElement('li');
        li.textContent = name;
        li.title = name;
        li.onclick = () => switchPage(name);
        pageList.appendChild(li);
      }
    }

    function switchPage(name) {
      // Save current content before switching
      if (currentPage && currentPage !== 'Overview') {
        pages[currentPage] = editor.value;
      }

      currentPage = name;
      fileName.textContent = name.includes('/') ? name.split('/').pop() : name;
      
      document.querySelectorAll('#pageList li').forEach(li => {
        li.classList.remove('active');
      });
      
      if (name.includes('/')) {
        const [folderName, fileName] = name.split('/');
        document.querySelectorAll('.folder-name').forEach(folder => {
          if (folder.textContent === folderName) {
            folder.classList.add('expanded');
          }
        });
        document.querySelectorAll('.folder-item').forEach(item => {
          if (item.textContent === fileName) {
            item.classList.add('active');
          }
        });
      } else {
        document.querySelectorAll('#pageList > li:not(.folder-name):not(.folder-item)').forEach(li => {
          if (li.textContent === name) {
            li.classList.add('active');
          }
        });
      }

      if (name === 'Overview') {
        editor.style.display = 'none';
        document.getElementById("code-editor").style.display = "none";
        highlightElement.style.display = 'none';
        readme.style.display = 'block';
        readme.innerHTML = `
          <h1>&#x2728; Let's build something amazing</h1>
          <span>&#x2728; Welcome to Jamesy Creator Code</span>
          <br>
          <ul style="list-style: none;" class="links">
            <li><a href="#" onclick="newPage()">üìù <span class="underline"> Create new file</span></a></li>
            <li><a href="#" onclick="openFiles()">üß© <span class="underline"> Open files</span></a></li>
            <li><a href="#" onclick="uploadFolder()">üìÅ <span class="underline"> Open folder</span></a></li>
            <li><a href="#" onclick="quit()">üìÅ <span class="underline"> Quit</span></a></li>
            
          </ul>
          <br>
          <h2>&#128220; Update Log</h2>
          <br>
          <ul class="updateLog">
            <li>Multiple file editing</li>
            <li>Folder structure with expandable sections</li>
            <li>Line and column position tracking</li>
            <li>Syntax highlighting for HTML, CSS, and JavaScript</li>
            <br>
            <h2>&#x1F9E9; Keyboard Shortcuts</h2>
            <br>
            <pre>
Ctrl+O / Cmd+O    - Open files
Ctrl+S / Cmd+S    - Save file
Ctrl+W / Cmd+W    - Close file</pre>
          </ul>
        `;
      } else {
        document.getElementById("code-editor").style.display = "block";
        editor.style.display = 'block';
        highlightElement.style.display = 'block';
        readme.style.display = 'none';
        editor.value = pages[name] || '';
        updateCursor();
        updateHighlighting();
        editor.focus();
      }
    }

    function saveFile() {
      if (!currentPage || currentPage === 'Overview') return alert("Cannot save 'Overview'");
      const blob = new Blob([editor.value], { type: "text/plain" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = currentPage.includes('/') ? currentPage.split('/').pop() : currentPage;
      a.click();
    }

    function openFiles() {
      const input = document.createElement("input");
      input.type = "file";
      input.multiple = true;
      input.accept = ".txt,.html,.js,.css,.md,.json,.py,.java,.php,.xml,.csv";
      input.onchange = e => {
        Array.from(e.target.files).forEach((file, i) => {
          const reader = new FileReader();
          reader.onload = () => {
            pages[file.name] = reader.result;
            addPageToList(file.name);
            if (i === 0) switchPage(file.name);
          };
          reader.readAsText(file);
        });
      };
      input.click();
    }

function renameFile() {
  if (!currentPage || currentPage === 'Overview') {
    alert("Cannot rename 'Overview'");
    return;
  }

  const newName = prompt("Rename file", currentPage.split('/').pop());
  if (!newName || newName === currentPage || newName === 'Overview') return;

  let newKey = newName;
  const isInFolder = currentPage.includes('/');
  if (isInFolder) {
    const folderName = currentPage.split('/')[0];
    newKey = `${folderName}/${newName}`;
  }

  if (pages[newKey]) {
    alert("A file with that name already exists.");
    return;
  }

  pages[newKey] = pages[currentPage];
  delete pages[currentPage];

  const items = document.querySelectorAll('#pageList li');
  items.forEach(item => {
    if (item.textContent === currentPage.split('/').pop()) {
      item.textContent = newName;
      item.onclick = () => switchPage(newKey);
      item.title = newKey;
    }
  });

  switchPage(newKey);
}


    function uploadFolder() {
      const input = document.createElement("input");
      input.type = "file";
      input.webkitdirectory = true;
      input.onchange = e => {
        const files = Array.from(e.target.files);
        if (files.length === 0) return;
        
        const folderName = files[0].webkitRelativePath.split('/')[0];
        const folderLi = document.createElement('li');
        folderLi.textContent = folderName;
        folderLi.className = 'folder-name';
        folderLi.title = folderName;
        
        const folderContents = document.createElement('ul');
        folderContents.className = 'folder-contents';
        
        folderLi.onclick = (e) => {
          e.stopPropagation();
          folderLi.classList.toggle('expanded');
        };
        
        pageList.appendChild(folderLi);
        pageList.appendChild(folderContents);

        files.forEach((file, i) => {
          const reader = new FileReader();
          reader.onload = () => {
            const fullPath = `${folderName}/${file.name}`;
            pages[fullPath] = reader.result;
            addPageToList(file.name, folderName);
            if (i === 0) switchPage(fullPath);
          };
          reader.readAsText(file);
        });
      };
      input.click();
    }

    function closePage() {
      if (currentPage === 'Overview') return alert("Cannot close 'Overview'");
      
      if (currentPage.includes('/')) {
        const [folderName, fileName] = currentPage.split('/');
        folders[folderName] = folders[folderName].filter(f => f !== fileName);
        
        // Remove from DOM
        document.querySelectorAll('.folder-item').forEach(item => {
          if (item.textContent === fileName) {
            item.remove();
          }
        });

        // Remove folder if empty
        if (folders[folderName].length === 0) {
          delete folders[folderName];
          document.querySelectorAll('.folder-name').forEach(folder => {
            if (folder.textContent === folderName) {
              folder.nextElementSibling.remove();
              folder.remove();
            }
          });
        }
      } else {
        document.querySelectorAll('#pageList > li:not(.folder-name):not(.folder-item)').forEach(li => {
          if (li.textContent === currentPage) {
            li.remove();
          }
        });
      }
      
      delete pages[currentPage];
      switchPage('Overview');
    }

    function handleKeyDown(e) {
      if ((e.ctrlKey || e.metaKey) && !e.altKey) {
        switch (e.key.toLowerCase()) {
          case 'o':
            e.preventDefault();
            openFiles();
            break;
          case 's':
            e.preventDefault();
            saveFile();
            break;
          case 'w':
            e.preventDefault();
            closePage();
            break;
          case 'n':
            if (e.shiftKey) {
              e.preventDefault();
              newPage();
            }
            break;
        }
      }
    }

    // Initialize the editor
    function initEditor() {
      pages['Overview'] = "";
      const readmeLi = document.createElement('li');
      readmeLi.textContent = 'Overview';
      readmeLi.title = 'Overview';
      readmeLi.onclick = () => switchPage('Overview');
      pageList.appendChild(readmeLi);
      switchPage('Overview');
    }

    initEditor();


     function quit() {
    window.close()
    setTimeout(() => {
       window.location.href = "https://jamesy-tech.github.io/jamesy-creator/";
    }, 100);
  }
  </script>
</body>
</html>
